var B=Object.defineProperty;var J=(t,n,o)=>n in t?B(t,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[n]=o;var f=(t,n,o)=>(J(t,typeof n!="symbol"?n+"":n,o),o);import{w as L,d as N}from"./entry.C2lZ5bbK.js";import{m as x}from"./Image.BYkkbeKT.js";import{r as w,R as h}from"./Navigation.lIIe-gxl.js";import{Q as E}from"./scheduler.DC8yHMXg.js";var O={local:{},session:{}};function Q(t){return t==="local"?localStorage:sessionStorage}function g(t,n,o){var e,r,a,c,q,V;const y=(e=void 0)!=null?e:JSON,p=(r=void 0)!=null?r:"local",j=(a=void 0)!=null?a:!0,F=(q=(c=void 0)!=null?c:void 0)!=null?q:s=>console.error(`Error when writing value from persisted store "${t}" to ${p}`,s),_=(V=void 0)!=null?V:(s,i)=>console.error(`Error when parsing ${s?'"'+s+'"':"value"} from persisted store "${t}"`,i),C=typeof window<"u"&&typeof document<"u",v=C?Q(p):null;function P(s,i){try{v==null||v.setItem(s,y.stringify(i))}catch(S){F(S)}}function R(){const s=v==null?void 0:v.getItem(t);if(s)try{return y.parse(s)}catch(i){_(s,i)}return n}if(!O[p][t]){const s=R(),i=L(s,d=>{if(C&&p=="local"&&j){const b=l=>{if(l.key===t){let I;try{I=l.newValue?y.parse(l.newValue):null}catch(A){_(l.newValue,A);return}d(I)}};return window.addEventListener("storage",b),()=>window.removeEventListener("storage",b)}}),{subscribe:S,set:z}=i;O[p][t]={set(d){z(d),P(t,d)},update(d){return i.update(b=>{const l=d(b);return P(t,l),l})},subscribe:S}}return O[p][t]}class u{constructor(n,o,e,r){f(this,"path");f(this,"name");f(this,"current");f(this,"index");f(this,"queue");this.path=n,this.name=o,this.index=e,this.current=typeof e=="number"?r[e]:null,this.queue=Array.from(r)}}function W(){const{subscribe:t,set:n,update:o}=L(new u("","",null,[]));return{subscribe:t,reset:()=>{n(new u("","",null,[]))},play:(e,r)=>{n(new u(e.path,e.longName,0,r)),m.set(x(e.id,E(m))),w.set(h.ChallengeViewOpen)},playFrom:(e,r,a)=>{const c=a.indexOf(r);if(c==-1)throw Error("Element must be in queue.");n(new u(e.path,e.longName,c,a)),m.set(x(e.id,E(m))),w.set(h.ChallengeViewOpen)},playSingle:(e,r,a)=>{if(a.indexOf(r.id)==-1)throw Error("Element must be in queue.");n(new u(e.path,r.name,0,[r.id])),m.set(x(e.id,E(m))),w.set(h.ChallengeViewOpen)},previous:()=>{o(e=>e.index===null?e:new u(e.path,e.name,(e.index+e.queue.length-1)%e.queue.length,e.queue)),w.set(h.ChallengeViewOpen)},next:()=>{o(e=>e.index===null?e:new u(e.path,e.name,(e.index+1)%e.queue.length,e.queue)),w.set(h.ChallengeViewOpen)}}}const X=W(),m=g("last-played",[]),Y=g("socket-first-bloods",[]),D=g("socket-challenge-list",null),Z=N(D,t=>t?Object.fromEntries(t.map(n=>[n.id,n])):null),G=g("socket-teams",null),$=N(G,t=>(t==null?void 0:t.filter(n=>n.points>0))??null),k=g("socket-latest-solves",null);export{g as a,k as b,$ as c,Y as f,m as l,X as p,Z as s};
